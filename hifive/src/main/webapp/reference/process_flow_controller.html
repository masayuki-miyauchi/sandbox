<!doctype html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=980">

<meta name="author" content="NS Solutions Corporation">
<meta name="copyright" content="Copyright (C) 2012 NS Solutions Corporation, All Rights Reserved.">

<link rel="shortcut icon" href="/ja/favicon.ico" type="image/vnd.microsoft.icon">
<link rel="icon" href="/ja/favicon.ico" type="image/vnd.microsoft.icon">
<link rel="apple-touch-icon" href="/ja/apple-touch-icon.png">

<title>hifive - HTML5とスマートフォンのための開発プラットフォーム</title>

<link rel="stylesheet" href="../css/frame.css" type="text/css" />

<!-- [begin] Page CSS -->

<link rel="stylesheet" href="css/article.css" type="text/css" />

<!-- [end] Page CSS -->

<!--[if lt IE 9]>
<script src="../lib/modernizr.js"></script>
<![endif]-->

<!-- [begin] Page Scripts -->

<!-- [end] Page Scripts -->

</head>
<body>
<header>
    <a href="../"><img src="../images/logo.png" width="319" height="112"></a>
    <nav>
        <ul class="globalNavSub">
            <li><a href="../qa.html">Q&amp;A</a></li>
            <li><a href="../devch/index.html">h5.dev.ch</a></li>
            <li><a href="http://blog.htmlhifive.com/">blog</a></li>
        </ul>

        <ul class="globalNavMain">
            <li><a href="../recipe.html">recipe</a></li>
            <li><a href="../tutorial/step01.html">tutorial</a></li>
            <li><a href="../reference/index.html">reference</a></li>
            <li><a href="../doc/h5.html">API docs</a></li>
            <li><span class="comingSoon">guide</span></li>
            <li class="headerDownload"><a href="/lets/download">download</a></li>
        </ul>
    </nav>
</header>

<div id="contents">
	<h1 class="title">コントローラの処理フロー</h1>
	<div class="contents contents2">
		<input type="hidden" name="contents2Level" value="0"><input
			type="hidden" name="contents2Filter" value=""><input
			type="hidden" name="contents2Count" value="-1"><input
			type="hidden" name="contents2CountLevel" value="0">
		<ul class="list1">
			<li><a href="#capture030250"> h5.core.controller() </a></li>
		</ul>
		<ul class="list1">
			<li><a href="#capture130250"> h5.core.bindController() </a></li>
		</ul>
	</div>
	<a class="anchor_super" id="capture030250"></a><h2 class="defaultCapture party">
		h5.core.controller()
	</h2>
	<p>h5.core.controller()メソッドを使ってコントローラをコントローラ化した時の処理フローです。</p>
	<p>コントローラ化については<a href="../tutorial/step04.html#capture125484">チュートリアル04.コントローラ &gt; 「コントローラ化」</a>をご覧ください。</p>
	<ol class="list1" style="padding-left: 12px; margin-left: 12px">
		<li>コントローラ名(__name)のチェックします。
			<ul class="list2" style="padding-left: 12px; margin-left: 12px">
				<li>なければエラーとして処理します。</li>
			</ul>
		</li>
		<li>初期化パラメータがあった場合、オブジェクトかどうかのチェックします。
			<ul class="list2" style="padding-left: 12px; margin-left: 12px">
				<li>オブジェクトでなければエラーとして処理します。</li>
			</ul>
		</li>
		<li>指定されたコントローラ定義オブジェクトが既にコントローラ化されているかどうかをチェックします。
			<ul class="list2" style="padding-left: 12px; margin-left: 12px">
				<li>既にコントローラ化されていればエラーとして処理します。</li>
			</ul>
		</li>
		<li>バインド対象となるDOM要素のチェック。
			<ul class="list2" style="padding-left: 12px; margin-left: 12px">
				<li>要素が存在しない、もしくは複数存在する場合はエラーとして処理します。</li>
			</ul>
		</li>
		<li>__templatesで指定されているテンプレートのパスから、テンプレートを読み込みます。</li>
		<li>コントローラのインスタンスを作成します。</li>
		<li>コントローラ定義オブジェクトの全プロパティに対して以下の処理を行い、コントローラのインスタンスのプロパティとして追加します。
			<ul class="list2" style="padding-left: 12px; margin-left: 12px">
				<li>プロパティがライフサイクルイベントの場合、AOPを適用します。</li>
				<li>プロパティがイベントハンドラの場合AOPを適用し、バインド情報を管理するマップに参照を追加します。<br>同一のセレクタとイベント名を持つイベントハンドラが2つ以上存在する場合、エラーとして処理します。</li>
				<li>プロパティがコントローラ(プロパティ名の接尾辞がController)の場合、まず循環参照の有無をチェックします。参照が循環している場合、エラーとして処理します。</li>
				<li>コントローラ化を実行します。子コントローラが子コントローラを持っている場合は再帰的にコントローラ化を行います。</li>
				<li>プロパティがロジック(プロパティ名の接尾辞がLogic)の場合、まず循環参照の有無をチェックします。参照が循環している場合、エラーとして処理します。</li>
				<li>ロジック化を実行します。ロジックが子ロジックを持っている場合は再帰的にロジック化を行います。</li>
				<li>プロパティがライフサイクルイベント、イベントハンドラのどちらでもない関数の場合、AOPを適用します。</li>
				<li>プロパティが上記以外の場合、何も実行しません。</li>
			</ul>
		</li>
		<li>メタ定義(__meta)のチェック。
			<ul class="list2" style="padding-left: 12px; margin-left: 12px">
				<li>__metaに指定された接尾辞がControllerであるプロパティが、undefined、null、またはコントローラではない場合、エラーとして処理します。</li>
			</ul>
		</li>
		<li>__controllerContext(__initPromiseと__readyPromiseを持つ)、templatePromise, initDfd, readyDfdを、コントローラのインスタンスに設定します。</li>
		<li>__constructを実行します。プロパティが存在しない場合実行しません。</li>
		<li>__rootController, __parentControllerを、コントローラのインスタンスに設定します。</li>
		<li>rootElementをコントローラのインスタンスに設定します。</li>
		<li>__initの実行します。プロパティが存在しない場合実行しません。</li>
		<li>イベントハンドラをバインドします。</li>
		<li>useHandlersがtrueの場合、子コントローラ及び子コントローラが保持するコントローラ(子孫コントローラ)のイベントハンドラをバインドします。</li>
		<li>コントローラのインスタンスを、グローバルコントローラの管理対象に追加します。</li>
		<li>controllerBoundイベントをトリガします。</li>
		<li>__readyを実行します。プロパティが存在しない場合実行しません。</li>
		<li>controllerReadyイベントをトリガします。</li>
	</ol>
	<a class="anchor_super" id="capture130250"></a><h2 class="defaultCapture party">
		h5.core.bindController()
	</h2>
	<p>
		h5.core.bindController()の使用は限られていますが、Controller.unbind()でバインドを解除した、
		h5.core.controller()で作成したコントローラのインスタンスを、再び指定したDOM要素にバインドしたい場合を想定しています。
	</p>
    <br>
    <br>
    <a href="index.html">←リファレンスへ戻る</a>
</div>

<nav id="globalFooterNav">
    <ul>
        <li><a href="../">home</a></li>
        <li><a href="../recipe.html">recipe</a></li>
        <li><a href="../tutorial/step01.html">tutorial</a></li>
        <li><a href="../reference/index.html">reference</a></li>
        <li><a href="../doc/h5.html">API doc</a></li>
        <li><span class="comingSoon">guide</span></li>
        <li><a href="/lets/download">download</a></li>
        <li><a href="../qa.html">Q&amp;A</a></li>
        <li><a href="../devch/index.html">h5.dev.ch</a></li>
        <li><a href="http://blog.htmlhifive.com/">blog</a></li>
    </ul>
</nav>
<footer>
    <ul class="notices">
        <li><a href="../notices.html#copyright">サイトのご利用にあたって</a></li>
        <li><a href="../notices.html#escape_clause">免責事項</a></li>
        <li><a href="../notices.html#privacy_policy">プライバシーポリシー</a></li>
        <li><a href="../notices.html#trademark">商標・登録商標について</a></li>
    </ul>
    <small class="footerCopyright">Copyright (C) 2012 NS Solutions Corporation, All Rights Reserved.</small>
</footer>
</body>
</html>
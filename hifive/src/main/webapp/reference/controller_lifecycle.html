<!doctype html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=980">

<meta name="author" content="NS Solutions Corporation">
<meta name="copyright" content="Copyright (C) 2012 NS Solutions Corporation, All Rights Reserved.">

<link rel="shortcut icon" href="/ja/favicon.ico" type="image/vnd.microsoft.icon">
<link rel="icon" href="/ja/favicon.ico" type="image/vnd.microsoft.icon">
<link rel="apple-touch-icon" href="/ja/apple-touch-icon.png">

<title>hifive - HTML5とスマートフォンのための開発プラットフォーム</title>

<link rel="stylesheet" href="../css/frame.css" type="text/css" />

<!-- [begin] Page CSS -->

<link rel="stylesheet" href="css/article.css" type="text/css" />
<link type="text/css" rel="stylesheet"
	href="../lib/syntaxhighlighter/styles/SyntaxHighlighter.css"></link>

<!-- [end] Page CSS -->

<!--[if lt IE 9]>
<script src="../lib/modernizr.js"></script>
<![endif]-->

<!-- [begin] Page Scripts -->

<script type="text/javascript"
	src="../lib/syntaxhighlighter/scripts/shCore.js"></script>
<script type="text/javascript"
	src="../lib/syntaxhighlighter/scripts/shBrushXml.js"></script>
<script type="text/javascript"
	src="../lib/syntaxhighlighter/scripts/shBrushJScript.js"></script>
<script type="text/javascript">
	window.onload = function() {
		dp.SyntaxHighlighter.ClipboardSwf = '../lib/syntaxhighlighter/scripts/clipboard.swf';
		dp.SyntaxHighlighter.HighlightAll('code');
	}
</script>

<!-- [end] Page Scripts -->

</head>
<body>
<header>
    <a href="../"><img src="../images/logo.png" width="319" height="112"></a>
    <nav>
        <ul class="globalNavSub">
            <li><a href="../qa.html">Q&amp;A</a></li>
            <li><a href="../devch/index.html">h5.dev.ch</a></li>
            <li><a href="http://blog.htmlhifive.com/">blog</a></li>
        </ul>

        <ul class="globalNavMain">
            <li><a href="../recipe.html">recipe</a></li>
            <li><a href="../tutorial/step01.html">tutorial</a></li>
            <li><a href="../reference/index.html">reference</a></li>
            <li><a href="../doc/h5.html">API docs</a></li>
            <li><span class="comingSoon">guide</span></li>
            <li class="headerDownload"><a href="/lets/download">download</a></li>
        </ul>
    </nav>
</header>

<div id="contents">
	<h1 class="title">コントローラのライフサイクル</h1>
	<div class="contents contents2">
		<input type="hidden" name="contents2Level" value="0"><input
			type="hidden" name="contents2Filter" value=""><input
			type="hidden" name="contents2Count" value="-1"><input
			type="hidden" name="contents2CountLevel" value="0">
		<ul class="list1">
			<li><a href="#capture029821"> 概要 </a></li>
		</ul>
		<ul class="list1">
			<li><a href="#capture129821"> __construct </a></li>
			<ul class="list2">
				<li><a href="#capture229821"> 実行までに行われる処理 </a></li>
				<li><a href="#capture329821"> 未実行の処理 </a></li>
			</ul>
		</ul>
		<ul class="list1">
			<li><a href="#capture429821"> __init </a></li>
			<ul class="list2">
				<li><a href="#capture529821"> 実行までに行われる処理 </a></li>
				<li><a href="#capture629821"> 未実行の処理 </a></li>
			</ul>
		</ul>
		<ul class="list1">
			<li><a href="#capture729821"> __ready </a></li>
			<ul class="list2">
				<li><a href="#capture829821"> 実行までに行われる処理 </a></li>
			</ul>
		</ul>
		<ul class="list1">
			<li><a href="#capture929821"> __unbind </a></li>
		</ul>
		<ul class="list1">
			<li><a href="#capture1029821"> 初期化パラメータ </a></li>
		</ul>
		<ul class="list1">
			<li><a href="#capture1129821"> 非同期処理と実行順序 </a></li>
		</ul>
		<ul class="list1">
			<li><a href="#capture1229821"> コントローラのネスト </a></li>
		</ul>
		<ul class="list1">
			<li><a href="#capture1329821"> 動的コントローラ </a></li>
		</ul>
	</div>
	<a class="anchor_super" id="capture029821"></a><h2>
		概要
	</h2>
	<p>
		コントローラにはライフサイクルがあります。<br>hifiveではコントローラのライフサイクルイベントとして、<span
			class="strong">__construct</span>, <span class="strong">__init</span>,
		<span class="strong">__ready</span>, <span class="strong">__unbind</span>
		の4つを定義しています。
	</p>
	<p>
		コントローラの生成時に呼ばれるライフサイクルイベント(__construct, __init, __ready)は実行順が決まっています。<br>それぞれのライフサイクルイベントに設定された関数が同期処理の場合、
	</p>
	<ol class="list1" style="padding-left: 12px; margin-left: 12px">
		<li>__construct</li>
		<li>__init</li>
		<li>__ready</li>
	</ol>
	<p>
		の順に実行されます。<br>また非同期処理の場合でも、Promiseオブジェクトを戻すことによって実行順を制御することができます。
	</p>
	<a class="anchor_super" id="capture129821"></a><h2>
		__construct
	</h2>
	<p>
		__constructはコントローラ化が終わった段階で呼ばれます。<br>
	</p>
	<a class="anchor_super" id="capture229821"></a><h3>
		実行までに行われる処理
	</h3>
	<ul class="list1" style="padding-left: 12px; margin-left: 12px">
		<li>コントローラ化</li>
	</ul>
	<a class="anchor_super" id="capture329821"></a><h3>
		未実行の処理
	</h3>
	<ul class="list1" style="padding-left: 12px; margin-left: 12px">
		<li>テンプレートのロード</li>
		<li>rootElementのセット(コントローラの要素へのバインド)</li>
		<li>__rootControllerと__parentControllerのセット</li>
		<li>イベントハンドラのバインド</li>
	</ul>
	<a class="anchor_super" id="capture429821"></a><h2>
		__init
	</h2>
	<p>
		__initはコントローラ化とテンプレートのロード、コントローラの要素へのバインドが終わった段階で呼ばれます。<br>
	</p>
	<a class="anchor_super" id="capture529821"></a><h3>
		実行までに行われる処理
	</h3>
	<ul class="list1" style="padding-left: 12px; margin-left: 12px">
		<li>コントローラ化</li>
		<li>テンプレートのロード</li>
		<li>rootElementのセット(コントローラの要素へのバインド)</li>
		<li>__rootControllerと__parentControllerのセット</li>
	</ul>
	<a class="anchor_super" id="capture629821"></a><h3>
		未実行の処理
	</h3>
	<ul class="list1" style="padding-left: 12px; margin-left: 12px">
		<li>イベントハンドラのバインド</li>
	</ul>
	<a class="anchor_super" id="capture729821"></a><h2>
		__ready
	</h2>
	<p>
		__readyは全ての処理が終わった段階で呼ばれます。<br>
	</p>
	<a class="anchor_super" id="capture829821"></a><h3>
		実行までに行われる処理
	</h3>
	<ul class="list1" style="padding-left: 12px; margin-left: 12px">
		<li>コントローラ化</li>
		<li>テンプレートのロード</li>
		<li>rootElementのセット(コントローラの要素へのバインド)</li>
		<li>__rootControllerと__parentControllerのセット</li>
		<li>イベントハンドラのバインド</li>
	</ul>
	<a class="anchor_super" id="capture929821"></a><h2>
		__unbind
	</h2>
	<p>
		コントローラ化を行ったときに追加されるメソッドunbind()を実行すると、__unbindが呼ばれます。
	</p>
	<a class="anchor_super" id="capture1029821"></a><h2>
		初期化パラメータ
	</h2>
	<p>
		__unbindを除く3つのライフサイクルイベントには、h5.core.controller(element, controller,
		param); の<br>第3引数に渡されたオブジェクトを格納したライフサイクルイベントコンテキストが渡されます。<br>初期化時にパラメータが必要な場合に使用します。<br>
	</p>
	<pre name="code" class="js">var controller = {
&nbsp;&nbsp;__name: 'SampleController',
&nbsp;
&nbsp;&nbsp;__construct: function(context) {
&nbsp;&nbsp;&nbsp;&nbsp;var param = context.args;
&nbsp;&nbsp;&nbsp;&nbsp;this.log.info(param.construct); // "construct"とコンソールに表示
&nbsp;&nbsp;},
&nbsp;
&nbsp;&nbsp;__init: function(context) {
&nbsp;&nbsp;&nbsp;&nbsp;var param = context.args;
&nbsp;&nbsp;&nbsp;&nbsp;this.log.info(param.init); // "init"とコンソールに表示
&nbsp;&nbsp;},
&nbsp;
&nbsp;&nbsp;__ready: function(context) {
&nbsp;&nbsp;&nbsp;&nbsp;var param = context.args;
&nbsp;&nbsp;&nbsp;&nbsp;this.log.info(param.ready); // "ready"とコンソールに表示
&nbsp;&nbsp;},
&nbsp;
&nbsp;&nbsp;__unbind: function() {
&nbsp;&nbsp;&nbsp;&nbsp;// __unbindは引数を取らない
&nbsp;&nbsp;}
};
&nbsp;
h5.core.controller(element, controller, {
&nbsp;&nbsp;construct: 'construct',
&nbsp;&nbsp;init: 'init',
&nbsp;&nbsp;ready: 'ready'
});</pre>
	<a class="anchor_super" id="capture1129821"></a><h2>
		非同期処理と実行順序
	</h2>
	<p>
		__init, __readyで非同期処理の実行と実行順の制御を両立させたい場合、<br>それぞれのイベントでPromiseオブジェクト<a
			id="notetext_1" href="#notefoot_1" class="note_super">*1</a>を戻すことによって実現できます。<a
			id="notetext_2" href="#notefoot_2" class="note_super">*2</a>
	</p>
	<pre name="code" class="js">var controller = {
&nbsp;&nbsp;__name: 'SampleController',
&nbsp;
&nbsp;&nbsp;__construct: function(context) {
&nbsp;&nbsp;&nbsp;&nbsp;var param = context.args;
&nbsp;&nbsp;&nbsp;&nbsp;this.log.info(param.construct); // "construct"とコンソールに表示
&nbsp;&nbsp;},
&nbsp;
&nbsp;&nbsp;__init: function(context) {
&nbsp;&nbsp;&nbsp;&nbsp;var dfd = this.deferred();
&nbsp;&nbsp;&nbsp;&nbsp;setTimeout(function() {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var param = context.args;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.log.info(param.init); // 300ms後に"init"とコンソールに表示
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dfd.resolve();
&nbsp;&nbsp;&nbsp;&nbsp;}, 300);
&nbsp;&nbsp;&nbsp;&nbsp;return dfd.promise();
&nbsp;&nbsp;},
&nbsp;
&nbsp;&nbsp;__ready: function(context) {
&nbsp;&nbsp;&nbsp;&nbsp;var param = context.args;
&nbsp;&nbsp;&nbsp;&nbsp;this.log.info(param.ready); // __"ready"とコンソールに表示
&nbsp;&nbsp;}
};
&nbsp;
h5.core.controller(element, controller, {
&nbsp;&nbsp;construct: 'construct',
&nbsp;&nbsp;init: 'init',
&nbsp;&nbsp;ready: 'ready'
});</pre>
	<a class="anchor_super" id="capture1229821"></a><h2>
		コントローラのネスト
	</h2>
	<a class="anchor_super" id="capture1329821"></a><h2>
		動的コントローラ
	</h2>
	<div id="note">
		<hr class="note_hr">
		<a id="notefoot_1" href="#notetext_1" class="note_super">*1</a><span
			class="small">Promiseオブジェクトについては<a href="../tutorial/step07.html#capture325489"
			title="チュートリアル07.非同期処理">こちら</a>を参照してください。
		</span><br> <a id="notefoot_2" href="#notetext_2" class="note_super">*2</a><span
			class="small">_constructの非同期処理はサポートしていません。</span><br>
	</div>
    <br>
    <br>
    <a href="index.html">←リファレンスへ戻る</a>
</div>

<nav id="globalFooterNav">
    <ul>
        <li><a href="../">home</a></li>
        <li><a href="../recipe.html">recipe</a></li>
        <li><a href="../tutorial/step01.html">tutorial</a></li>
        <li><a href="../reference/index.html">reference</a></li>
        <li><a href="../doc/h5.html">API doc</a></li>
        <li><span class="comingSoon">guide</span></li>
        <li><a href="/lets/download">download</a></li>
        <li><a href="../qa.html">Q&amp;A</a></li>
        <li><a href="../devch/index.html">h5.dev.ch</a></li>
        <li><a href="http://blog.htmlhifive.com/">blog</a></li>
    </ul>
</nav>
<footer>
    <ul class="notices">
        <li><a href="../notices.html#copyright">サイトのご利用にあたって</a></li>
        <li><a href="../notices.html#escape_clause">免責事項</a></li>
        <li><a href="../notices.html#privacy_policy">プライバシーポリシー</a></li>
        <li><a href="../notices.html#trademark">商標・登録商標について</a></li>
    </ul>
    <small class="footerCopyright">Copyright (C) 2012 NS Solutions Corporation, All Rights Reserved.</small>
</footer>
</body>
</html>